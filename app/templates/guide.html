{% extends "_base.html" %}
{% block title %}Guide · HARCi{% endblock %}

{% block content %}
<div class="mx-auto max-w-6xl px-4 conversation-shell">
  <!-- 4-row grid: 40% / 30% / auto / 30% (by fr) -->
  <div class="grid h-full grid-rows-[4fr_3fr_auto_3fr] gap-3">

    <!-- Row 1: Avatar (fixed top) -->
    <section class="relative overflow-hidden rounded-2xl border border-white/10 bg-black">
      <video id="remoteVideo" class="w-full h-full object-cover bg-black" playsinline autoplay muted></video>
      <audio id="remoteAudio" playsinline></audio>

      <!-- Status chip -->
      <div class="absolute left-3 top-3 flex items-center gap-2">
        <span class="inline-flex items-center rounded-full border border-white/10 bg-neutral-900/70 px-3 py-1 text-[11px]">
          <span id="statusDot" class="mr-2 h-2 w-2 rounded-full"></span>
          <span id="statusText">Tap start</span>
        </span>
      </div>
    </section>

    <!-- Row 2: Briefing (the only scroll area) -->
    <section class="rounded-2xl border border-white/10 bg-neutral-800/50 p-4 scroll-area">
      <div id="briefing" class="prose prose-invert max-w-none text-sm leading-snug"></div>

      <!-- Optional image lives inside scroll area -->
      <div id="imagePanel" class="hidden mt-3 overflow-hidden rounded-xl border border-white/10 bg-neutral-900/40">
        <img id="briefImage" alt="" class="w-full object-cover" />
        <div class="p-2 text-[11px] text-neutral-300"><span id="imgAlt"></span></div>
      </div>
    </section>

    <!-- Row 3: Chips + Ask input (caption will appear in the input) -->
    <section class="rounded-2xl border border-white/10 bg-neutral-900/40 p-3">
      <div id="quickChips" class="flex gap-2 overflow-x-auto pb-2">
        <button class="chip" data-prompt="Agenda">Agenda</button>
        <button class="chip" data-prompt="Venue Map">Venue Map</button>
        <button class="chip" data-prompt="Speakers">Speakers</button>
        <button class="chip" data-prompt="Help">Help</button>
      </div>

      <form id="askForm" class="mt-2 flex items-stretch gap-2">
        <input id="txtAsk"
               type="text"
               placeholder="Type or press-and-hold the mic to speak…"
               class="input text-sm" />
        <button id="btnAsk" type="submit" class="btn btn-brand text-sm">Ask</button>
      </form>
    </section>

    <!-- Row 4: Controls bar -->
    <footer class="flex items-center justify-between">
      <!-- One toggle button: Start ➜ End -->
      <button id="btnSessionToggle" class="btn btn-outline">
        Start session
      </button>

      <!-- Big push-to-talk mic (center) -->
      <button id="btnHoldMic"
              class="btn-circle"
              aria-label="Hold to talk">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.7">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 14a3 3 0 0 0 3-3V7a3 3 0 1 0-6 0v4a3 3 0 0 0 3 3z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 11a7 7 0 0 1-14 0m7 7v-2" />
        </svg>
        <span class="sr-only">Hold to talk</span>
      </button>

      <!-- Right spacer (keeps mic centered) -->
      <div class="w-[140px]"></div>
    </footer>
  </div>
</div>
{% endblock %}
